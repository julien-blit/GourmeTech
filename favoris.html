<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="style.css">

  <title>Mes Recettes</title>
  <style>

body.dark-mode {
  background-color: #121212;
  color: #eee;
}

body.dark-mode .card,
body.dark-mode .fiche-recette,
body.dark-mode .favori,
body.dark-mode input,
body.dark-mode button,
body.dark-mode .search-container,
body.dark-mode .filter-container {
  background-color: #1e1e1e;
  color: #eee;
  border-color: #444;
}

/* Pour le champ de recherche et les filtres */
body.dark-mode input::placeholder {
  color: #ccc;
}

/* Boutons */
body.dark-mode .btn-orange {
  background-color: #ff9800;
  color: black;
}
body.dark-mode .btn-orange:hover {
  background-color: #e67600;
}

/* Les √©tiquettes color√©es peuvent garder leurs couleurs, mais on peut ajuster le contraste si besoin */
body.dark-mode .tag.orange {
  background-color: #ff9800;
}
body.dark-mode .tag.green {
  background-color: #4caf50;
}
body.dark-mode .tag.blue {
  background-color: #2196f3;
}

body {
  font-family: Arial, sans-serif;
  margin: 20px;
}
.card, .fiche-recette, .favori {
  border: 1px solid #ddd;
  padding: 10px;
  margin: 10px 0;
}
.card-img, .recette-img {
  width: 100%;
  max-width: 300px;
  border-radius: 8px;
}
.content-center {
  display: flex;
  min-width: 90%;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.row {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
}
.card {
  width: 275px;
  border-radius: 8px;
}
.hidden {
  display: none;
}
.favori {
  display: flex;
  align-items: center;
  gap: 10px;
}
.favori img {
  width: 100px;
}
.tag {
display: inline-block;
padding: 6px 12px;
border-radius: 20px;
font-size: 0.8em;
font-weight: bold;
color: white;
margin: 2px;
}

.tag.orange {
background-color: orange;
}

.tag.green {
background-color: #28a745;
}

.tag.blue {
background-color: #007bff;
}

.btn-orange {
background-color: orange;
color: white;
border: none;
padding: 8px 12px;
border-radius: 2px;
cursor: pointer;
font-weight: bold;
transition: background-color 0.2s ease;
text-align: center;
}

.btn-orange:hover {
background-color: darkorange;
}
.card button {
display: block;
margin: 10px auto 0; /* espace au-dessus et centr√© */
text-align: center;
}

.coeur {
position: absolute;
top: 10px;
right: 10px;
font-size: 20px;
cursor: pointer;
transition: transform 0.2s ease;
}
.coeur.active {
transform: scale(1.3);
}
.recette-header .coeur {
position: absolute;
top: 10px;
right: 10px;
font-size: 26px;
z-index: 3;
}

</style>
</head>
<body>
  <header>
    <div>
     <nav>
         <button class="menu-toggle" id="btn">Menu</button>
         <ul class="nav-links" id="nav-links">
             <div class="logo-title">
                 <div class="logo">
                     <span class="letter">G</span>
                 </div>
                 <h1 class="title">GourmeTech</h1>
             </div>
             <li><a href="index.html">Accueil</a></li>
             <li><a href="ajouter-recettes.html">Ajouter une recette</a></li>
             <li><a href="favoris.html" id="lien-favoris">Mes Favoris</a></li>
             <li><a href="apropos.html">√Ä Propos</a></li>
             <li><button class="dark-toggle" id="dark-mode-toggle">üåô</button></li>
         </ul>
     </nav>
     </div>
 </header>
 <section class="search">
 <div class="general">


     <div class="search-container">
        <!--  <input type="text" placeholder="Rechercher une recette..." class="search-input"> -->
         <input type="search" id="champ-recherche" placeholder=" Rechercher une recette..." style="margin: 10px 0; padding: 8px; width: 100%; max-width: 600px;"/>
         <button class="search-button">Rechercher</button>
     </div>


     <div class="filter-container">
     <div class="filter-group">
         <p>Cat√©gorie :</p>
         <label><input type="checkbox" name="category" value="entr√©e"> Entr√©e</label>
         <label><input type="checkbox" name="category" value="plat"> Plat</label>
         <label><input type="checkbox" name="category" value="dessert"> Dessert</label>
         <label><input type="checkbox" name="category" value="boisson"> Boisson</label>
     </div>

     <div class="filter-group">
         <p>Temps de pr√©paration :</p>
         <label><input type="checkbox" name="time" value="-15"> -15 min</label>
         <label><input type="checkbox" name="time" value="15-30"> 15‚Äì30 min</label>
         <label><input type="checkbox" name="time" value="+30"> +30 min</label>
     </div>

     <div class="filter-group">
         <p>Difficult√©:</p>
         <label><input type="checkbox" name="difficulty" value="Easy"> Facile</label>
         <label><input type="checkbox" name="difficulty" value="Intermediate"> Moyen</label>
         <label><input type="checkbox" name="difficulty" value="Advanced"> Difficile</label>
     </div>
     </div>
      </div>
</section>

  <main>
    <div class="content-center">
      <h1 id="page-title">Toutes les Recettes</h1>   
      <div id="liste-recettes" class="row"></div>

      <div id="detail-recette" class="fiche-recette hidden">
        <h1 id="recette-titre"></h1>
        <div class="recette-header" style="position: relative;">
          <span id="coeur-detail" class="coeur" style="z-index: 2;"></span>
          <img id="recette-image" src="" alt="Image recette" class="recette-img" />
          <div class="infos-recette">
            <p id="recette-categorie"></p>
            <p id="recette-temps"></p>
            <p id="recette-difficulte"></p>
          </div>
        </div>

        <section>
          <h2>Ingr√©dients</h2>
          <ul id="liste-ingredients"></ul>
        </section>
        <section>
          <h2>√âtapes</h2>
          <ol id="liste-instructions"></ol>
        </section>
        <button onclick="retourListe()">‚Üê Retour √† la liste</button>
      </div>

  </div>  

<!--
    <h2>Mes recettes favorites ‚ù§Ô∏è</h2>
    <div id="liste-favoris"></div>
    <p id="message-vide" style="display: none;">Aucune recette favorite pour l‚Äôinstant.</p>
-->


  </main>

  <script>
    let recettes = [];

    document.addEventListener("DOMContentLoaded", async () => {
      const fichiers = ["ratatouille.json", "veloute-potiron.json", "tarte-pomme.json"];
      try {
        const resultats = await Promise.all(fichiers.map(f => fetch(f).then(r => r.json())));
        recettes = resultats.flat();
        chargerListeRecettes();
      } catch (e) {
        console.error("Erreur chargement recettes :", e);
      }

      document.getElementById("champ-recherche").addEventListener("input", filtrerRecettes);
    });

function chargerListeRecettes(recettesFiltrees = recettes) {
  const container = document.getElementById("liste-recettes");
  container.innerHTML = recettesFiltrees.length ? "" : "<p>Aucune recette trouv√©e.</p>";
  document.getElementById("detail-recette").classList.add("hidden");
  container.classList.remove("hidden");

  recettesFiltrees.forEach(r => {
    const isFav = estFavori(r.id);
    container.innerHTML += `
      <div class="card">
        <div class="img-container">
          <span class="coeur ${isFav ? 'active' : ''}" data-id="${r.id}">${isFav ? '‚ù§Ô∏è' : 'ü§ç'}</span>
          <img class="card-img" src="${r.image}" alt="${r.titre}">
        </div>
        <h3>${r.titre}</h3>
        <p>
          <span class="tag orange">${r.categorie}</span>
          <span class="tag green">${r.temps}</span>
          <span class="tag blue">${r.difficulte}</span>
        </p>
        <button class="btn-orange" onclick="afficherDetail('${r.id}')">Voir la recette</button>
      </div>`;
  });

  // apr√®s la recharge, le c≈ìur est activ√©
  document.querySelectorAll(".coeur").forEach(coeur => {
    coeur.addEventListener("click", () => {
      const id = coeur.dataset.id;
      const recette = recettes.find(r => r.id === id);
      const estAjout√© = ajouterOuRetirerFavori(id, recette.titre, recette.image);
      coeur.classList.toggle("active");
      coeur.textContent = estAjout√© ? "‚ù§Ô∏è" : "ü§ç";
      afficherFavoris();
    });
  });

  afficherFavoris();
}


    function filtrerRecettes() {
      const recherche = document.getElementById("champ-recherche").value.toLowerCase();
      const filtres = recettes.filter(r => r.titre.toLowerCase().includes(recherche));
      chargerListeRecettes(filtres);
    }

    function afficherDetail(id) {
      const r = recettes.find(recette => recette.id === id);
      if (!r) return;

      document.getElementById("page-title").textContent = r.titre;
      document.getElementById("recette-titre").textContent = r.titre;
      document.getElementById("recette-image").src = r.image;
      document.getElementById("recette-categorie").textContent = "Cat√©gorie : " + r.categorie;
      document.getElementById("recette-temps").textContent = "Temps : " + r.temps;
      document.getElementById("recette-difficulte").textContent = "Difficult√© : " + r.difficulte;

      document.getElementById("liste-ingredients").innerHTML = r.ingredients.map(i => `<li>${i}</li>`).join('');
      document.getElementById("liste-instructions").innerHTML = r.instructions.map(i => `<li>${i}</li>`).join('');

      const coeurDetail = document.getElementById("coeur-detail");
      const estFav = estFavori(r.id);
      coeurDetail.classList.toggle("active", estFav);
      coeurDetail.textContent = estFav ? "‚ù§Ô∏è" : "ü§ç";
      coeurDetail.dataset.id = r.id;

      coeurDetail.onclick = () => {
        const res = ajouterOuRetirerFavori(r.id, r.titre, r.image);
        coeurDetail.classList.toggle("active", res);
        coeurDetail.textContent = res ? "‚ù§Ô∏è" : "ü§ç";
        afficherFavoris();
      };

      document.getElementById("liste-recettes").classList.add("hidden");
      document.getElementById("detail-recette").classList.remove("hidden");
    }

    function retourListe() {
      chargerListeRecettes();
      document.getElementById("champ-recherche").value = "";
    }

    function estFavori(id) {
      return (JSON.parse(localStorage.getItem("recettesFavoris")) || []).some(f => f.id === id);
    }

    function ajouterOuRetirerFavori(id, titre, image) {
      let favoris = JSON.parse(localStorage.getItem("recettesFavoris")) || [];
      const index = favoris.findIndex(f => f.id === id);
      if (index >= 0) {
        favoris.splice(index, 1);
      } else {
        favoris.push({ id, titre, image });
      }
      localStorage.setItem("recettesFavoris", JSON.stringify(favoris));
      return index < 0;
    }

    function afficherFavoris() {
      const favoris = JSON.parse(localStorage.getItem("recettesFavoris")) || [];
      const container = document.getElementById("liste-favoris");
      const msgVide = document.getElementById("message-vide");

      container.innerHTML = favoris.map(fav => `
      <div class="recette-header" style="position: relative;">  
      <div class="favori"> 
          <img id="recette-image" src="${fav.image}" alt="${fav.titre}" class="card-img" >         
          <strong>${fav.titre}</strong>         
      </div></div>`).join('');
      // <button onclick="retirerFavori('${fav.id}')">‚ùå</button>


       msgVide.style.display = favoris.length ? "none" : "block";
    }

    function retirerFavori(id) {
      const favoris = (JSON.parse(localStorage.getItem("recettesFavoris")) || []).filter(f => f.id !== id);
      localStorage.setItem("recettesFavoris", JSON.stringify(favoris));
      afficherFavoris();
    }

  document.getElementById("lien-favoris").addEventListener("click", (e) => {
    e.preventDefault(); // Emp√™che le comportement par d√©faut du lien

    // R√©cup√®re les recettes enregistr√©es dans les favoris depuis le localStorage
    const favoris = JSON.parse(localStorage.getItem("recettesFavoris")) || [];

    // Filtre les recettes qui sont dans les favoris
    const recettesFavoris = recettes.filter(r =>
      favoris.some(f => f.id === r.id)
    );

    // Change le titre de la page en "Mes Recettes Favorites"
    document.getElementById("page-title").textContent = "Mes Recettes Favorites ‚ù§Ô∏è";
    document.getElementById("champ-recherche").value = ""; // Vide le champ de recherche
    chargerListeRecettes(recettesFavoris); // Affiche les recettes favorites
  });

  //

  document.addEventListener("DOMContentLoaded", () => {
  // Add lien link "Mes Favoris"
  document.getElementById("lien-favoris").addEventListener("click", (e) => {
    e.preventDefault(); // empeche le comportement default du lien

    // prendre la recette des favorites de localStorage
    const favoris = JSON.parse(localStorage.getItem("recettesFavoris")) || [];
    const recettesFavoris = recettes.filter(r => favoris.some(f => f.id === r.id));

   // Met √† jour le titre de la page
    document.getElementById("page-title").textContent = "Mes Recettes Favorites ‚ù§Ô∏è";

   // Vide le champ de recherche
    document.getElementById("champ-recherche").value = "";

   // Affiche de nouveau toutes les recettes
    chargerListeRecettes(recettesFavoris);

    // Masque la liste des recettes favorites, affiche toutes les recettes
    document.getElementById("liste-recettes").classList.remove("hidden");
    document.getElementById("detail-recette").classList.add("hidden");
  });

  // Add le lien pour "Toutes les Recettes"
  const lienTousRecettes = document.querySelector('a[href="#"]');
  lienTousRecettes.addEventListener("click", (e) => {
    e.preventDefault(); // // Emp√™che le comportement par d√©faut du lien

    // Met √† jour le titre de la page
    document.getElementById("page-title").textContent = "Toutes les Recettes";

   // Vide le champ de recherche
    document.getElementById("champ-recherche").value = "";

    // Affiche de nouveau toutes les recettes
    chargerListeRecettes();

    // Masque la liste des recettes favorites, affiche toutes les recettes
    document.getElementById("liste-recettes").classList.remove("hidden");
    document.getElementById("detail-recette").classList.add("hidden");
  });
});



  </script>
  <footer  class="footer">
    <p class="copyright">¬© 2025 GourmeTech - Tous droits r√©serv√©s</p>
   </footer>
   <script src="script.js"></script>



</body>
</html>